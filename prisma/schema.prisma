datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

generator client {
  provider = "prisma-client-js"
}

model attr {
  id         BigInt   @id
  user_id    String   @db.VarChar(128)
  app        Int
  key1       String   @db.VarChar(512)
  key2       String?  @db.VarChar(512)
  text       String?  @db.VarChar(4096)
  bool       Boolean?
  long_val   BigInt?
  double_val Float?   @db.Real
}

model key_value {
  type        String   @db.VarChar(256)
  key         String   @db.VarChar(4096)
  value       String?
  update_time DateTime @db.Timestamptz(6)

  @@id([type, key])
}

model node {
  id          BigInt    @id
  app         Int
  name        String?   @db.VarChar(1024)
  title       String?   @db.VarChar(4096)
  html        String?   @db.VarChar(102400)
  parent_id   BigInt?
  children    String?   @db.VarChar(4096)
  user_id     String    @db.VarChar(128)
  access      Int       @default(0)
  type        String?   @db.VarChar(64)
  data        String?   @db.VarChar(102400)
  has_title   Boolean   @default(false)
  alias_id    String?   @unique @db.VarChar(512)
  create_time DateTime  @db.Timestamptz(6)
  update_time DateTime? @db.Timestamptz(6)
  version     Int       @default(0)
  space       BigInt?
  text        String?   @db.VarChar(102400)

  @@index([app, user_id], map: "index_node_app_user")
  @@index([app, user_id, access], map: "index_node_app_user_access")
  @@index([parent_id], map: "index_node_parent_id")
  @@index([user_id, id], map: "index_node_user_id")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model node_attr {
  node_id BigInt?
  key     String? @db.VarChar(256)
  value   String? @db.VarChar(102400)

  @@ignore
}

model space {
  id      Int @id
  code    String @db.VarChar(255)
  root_id Int
}

model users {
  id            BigInt   @id
  username      String?  @db.VarChar(255)
  create_time   DateTime @db.Timestamptz(6)
  email         String   @unique @db.VarChar(4096)
  hash_password String   @db.VarChar(4096)
  password      String   @db.VarChar(4096)
}
